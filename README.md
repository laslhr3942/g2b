# 나라장터 용역 정보 검색기 Pro

입찰공고와 사전규격 정보를 검색할 수 있는 Streamlit 웹 애플리케이션입니다.

## 🚀 주요 기능

- ✅ 입찰공고 검색
- ✅ 사전규격 검색
- ✅ 날짜 범위 지정
- ✅ 결과 캐싱 (10분)
- ✅ API 엔드포인트 자동 폴백
- ✅ 상세한 에러 처리 및 로깅

## 📋 사전 준비

### 1. 공공데이터포털에서 API 키 발급받기

1. [공공데이터포털](https://www.data.go.kr) 접속 및 회원가입/로그인
2. 다음 두 개의 API를 각각 활용신청:
   - **나라장터 입찰정보 조회 서비스**
   - **나라장터 입찰정보 사전규격 조회 서비스**
3. 승인 완료 후 마이페이지에서 각 API의 인증키 복사

⚠️ **중요**: 두 API는 **서로 다른 인증키**를 사용합니다!

### 2. Secrets 파일 설정

프로젝트 루트 디렉토리에 `.streamlit/secrets.toml` 파일을 생성하고 다음 내용 입력:

```toml
bid_api_key = "입찰공고_API_인증키를_여기에_붙여넣기"
spec_api_key = "사전규격_API_인증키를_여기에_붙여넣기"
```

**Streamlit Cloud에 배포하는 경우:**
1. Streamlit Cloud 대시보드 접속
2. 앱 설정 → Secrets 메뉴
3. 위 내용을 그대로 붙여넣기

## 💻 설치 및 실행

### 로컬 환경

```bash
# 필요한 패키지 설치
pip install streamlit requests

# 앱 실행
streamlit run nara_market_app_upgraded.py
```

### 필요한 패키지

```
streamlit
requests
```

## 📖 사용 방법

1. **검색 유형 선택**: 입찰공고 또는 사전규격
2. **검색어 입력**: 관심 키워드 (예: 기획, 디자인, 인공지능)
3. **기간 설정**: 시작일과 종료일 선택
4. **검색 시작** 버튼 클릭

## 🔧 고급 설정

사이드바의 "고급 설정"에서 다음을 조정할 수 있습니다:
- 표시할 결과 수 (10~100개)

## 🐛 문제 해결

### API 호출 실패 시

1. **API 키 확인**
   - 사이드바의 "🔑 API 키 상태"에서 두 키가 모두 설정되었는지 확인
   - 키를 정확히 복사했는지 재확인

2. **활용신청 상태 확인**
   - 공공데이터포털 마이페이지에서 두 API가 모두 "승인" 상태인지 확인
   - 대기중/반려 상태라면 승인 완료 후 재시도

3. **검색 조건 변경**
   - 검색 기간을 좁혀서 재시도
   - 다른 검색어로 시도

### 결과가 없을 때

- 검색 기간을 늘려보세요
- 검색어를 더 일반적인 단어로 변경해보세요
- 공공 입찰 특성상 특정 기간에 해당 키워드의 공고가 없을 수 있습니다

## 📊 코드 구조

```
nara_market_app_upgraded.py
├── 설정 상수 (API_CONFIG, API_ENDPOINTS, FIELD_MAPPING)
├── 유틸리티 함수
│   ├── format_datetime()
│   ├── get_api_key()
│   └── validate_date_range()
├── API 호출 함수
│   ├── fetch_nara_data() - @st.cache_data
│   └── parse_items()
├── UI 렌더링 함수
│   ├── render_item_card()
│   └── display_results()
└── main() - 메인 앱 로직
```

## 🎨 주요 개선사항 (v2.0)

- ✨ API 키를 검색 유형별로 분리 (입찰공고/사전규격)
- ✨ 구체적인 예외 처리 (Timeout, RequestException 등)
- ✨ 함수 모듈화 및 단일 책임 원칙 적용
- ✨ Type hints 추가
- ✨ 결과 캐싱으로 성능 향상
- ✨ 로깅 시스템 추가
- ✨ API 키 상태 표시
- ✨ 개발자 디버그 정보 제공

## 📝 라이선스

이 프로젝트는 공공데이터포털의 오픈 API를 활용합니다.

## 🤝 기여

버그 리포트나 기능 제안은 Issue를 통해 알려주세요!
